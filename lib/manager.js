//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYW5hZ2VyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBO0NBQUEsS0FBQSxFQUFBO0tBQUE7O3VCQUFBO0NBQUE7Q0FBQSxDQUFBLENBQVMsQ0FBQyxDQUFWLEVBQW1COztDQUFuQixDQUNBLENBQVMsRUFBSzs7Q0FEZCxDQUdNLEdBQUs7Q0FDVDtDQUFBOztDQUFBLEdBQUEsQ0FBYyxDQUFkLENBQUM7O0NBRVksRUFBQSxDQUFBLGFBQUE7Q0FDWCxDQUFBLENBQWUsQ0FBZCxFQUFELEtBQUE7Q0FBQSxDQUNnQixFQUFmLEVBQUQsRUFBQTtDQURBLEVBRUEsQ0FBQyxFQUFELEdBQUEsSUFBSztDQUxQLElBRWE7O0NBRmIsRUFPQSxNQUFLO0NBQ0gsU0FBQSwyQkFBQTtDQUFBLEtBREksaURBQ0o7QUFBQSxDQUFBO1lBQUEsc0NBQUE7Z0NBQUE7Q0FBQSxHQUFDLEVBQUQ7Q0FBQTt1QkFERztDQVBMLElBT0s7O0NBUEwsRUFVUSxHQUFSLEdBQVMsQ0FBRDtDQUNOLFNBQUEsRUFBQTtDQUFBLENBQTBCLENBQUEsQ0FBMUIsRUFBQSxFQUFBLENBQTBCLENBQWhCO0NBQ1IsR0FBQSxRQUFBO0NBQUEsT0FEeUIsK0NBQ3pCO0NBQUMsQ0FBa0IsRUFBWSxDQUE5QixFQUFELENBQVMsQ0FBc0IsQ0FBQSxHQUFBLENBQXRCLENBQVQ7Q0FERixNQUEwQjtDQUExQixDQUUyQixDQUFBLENBQTNCLEVBQUEsR0FBQSxDQUFVO0NBQ1AsQ0FBcUQsR0FBckQsQ0FBRCxDQUFvQixHQUFBLENBQVIsSUFBWjtDQURGLE1BQTJCO0NBRzFCLEdBQUEsTUFBRCxDQUFZLEVBQVo7Q0FoQkYsSUFVUTs7Q0FWUixFQWtCWSxNQUFBLENBQVo7Q0FDRyxDQUFrQixFQUFsQixDQUF5QixFQUExQixDQUFTLENBQWlCLElBQTFCO0NBbkJGLElBa0JZOztDQWxCWixFQXVCUSxHQUFSLEdBQVE7Q0FDTixTQUFBLG1DQUFBO0NBQUEsQ0FEZ0IsSUFBVCxpREFDUDtDQUFBO0NBQUE7WUFBQSwrQkFBQTt5QkFBQTtDQUNFLEdBQUcsQ0FBUSxFQUFYLENBQUE7Q0FDRSxHQUFJLElBQUosS0FBYztNQURoQixJQUFBO0NBR0UsR0FBSSxNQUFKLEdBQWdCO1VBSnBCO0NBQUE7dUJBRE07Q0F2QlIsSUF1QlE7O0NBdkJSOztDQUQwQixJQUFLOztDQUhqQyxDQWtDQSxHQUFLLEVBQUwsR0FBZ0I7Q0FDZixDQUFTLENBQUEsQ0FBUixFQUFBLEdBQVE7Q0FDTixHQUFBLE1BQUE7Q0FBQSxLQURPLGlEQUNQO0FBQUcsQ0FBSCxHQUFHLENBQWtCLENBQXJCLElBQUE7Q0FDRSxDQUFnQixFQUFmLElBQUQ7TUFERixFQUFBO0NBR0UsR0FBSSxHQUFKLENBQUE7Q0FBQSxHQUNDLEdBQUQsQ0FBQSxLQUFTO1FBSlg7Q0FETSxZQU1OO0NBTkgsSUFBUztDQUFULENBUVcsQ0FBQSxDQUFWLElBQUEsQ0FBVTtDQUNQLENBQUUsRUFBRixJQUFELEtBQUE7Q0FUSCxJQVFXO0NBUlgsQ0FXVyxDQUFBLENBQVYsSUFBQSxDQUFVO0NBQ1IsQ0FBRyxFQUFGLEVBQUQsRUFBQTtDQURRLFlBRVI7Q0FiSCxJQVdXO0NBWFgsQ0FlYSxDQUFBLENBQVosS0FBWSxDQUFaO0NBQ0UsQ0FBRyxFQUFGLEVBQUQsRUFBQSxHQUFBO0NBRFUsWUFFVjtDQWpCSCxJQWVhO0NBbERkLEdBa0NBOztDQWxDQSxDQXNETSxHQUFLO0NBQ1Y7Q0FBQTs7Q0FBQSxDQUFBLENBQWMsUUFBYjs7Q0FBRCxDQUFBLENBQ1MsR0FBUjs7Q0FERCxFQUdZLE1BQVgsSUFIRDs7Q0FLYyxFQUFBLENBQUEsV0FBQTtDQUNYLFNBQUEsa0JBQUE7U0FBQSxHQUFBO0NBQUEsS0FBQSxHQUFBLCtCQUFBO0FBRVcsQ0FGWCxFQUVXLENBQVYsQ0FBbUIsQ0FBcEIsQ0FBQTtDQUVBO0NBQUEsVUFBQTsyQkFBQTtDQUNFLEdBQXdFLElBQXhFLFNBQUE7Q0FBQSxFQUFMLENBQWtCLENBQVAsV0FBQSw4QkFBQTtVQUFOO0NBQUEsRUFDRSxDQUFBLENBQVcsR0FBYjtDQUFrQixDQUFRLEVBQVIsQ0FBQyxLQUFBO0NBRG5CLFNBQ2E7Q0FEYixFQUVBLENBQUMsSUFBRDtDQUhGLE1BSkE7Q0FTQTtDQUFBLENBQ1csQ0FBTixFQUFBLElBQUM7Q0FDRixPQUFBLElBQUE7QUFBb0IsQ0FBcEIsR0FBb0IsQ0FBQSxDQUFBLEVBQXBCLEVBQUE7Q0FBQSxFQUFXLEVBQVgsR0FBQSxFQUFBO1VBQUE7Q0FBQSxFQUNhLEtBQWIsQ0FBYTtDQUFHLElBQUEsU0FBQTtDQUFFLElBQUEsQ0FBRixHQUFBLEtBQWdCLEdBQWhCO0NBRGhCLFFBQ2E7Q0FDWixDQUFXLENBQVosRUFBQyxHQUFELE9BQUE7Q0FKSixNQUNLO0NBREwsVUFBQSxDQUFBOzRCQUFBO0NBQ0UsQ0FBUztDQURYLE1BVEE7Q0FlQSxHQUF3QixFQUF4QixHQUF5QjtDQUF6QixHQUFFLEVBQUYsRUFBQSxDQUFHO1FBaEJRO0NBTGQsSUFLYzs7Q0FMZCxFQXVCQyxNQUFNLENBQUQ7Q0FDSCxFQUFBLENBQUMsRUFBRCxDQUFRLEdBQVI7Q0FDQyxHQUFBLEVBQUQsSUFBQSxHQUFBO0NBekJILElBdUJNOztDQXZCTjs7Q0FEeUIsSUFBSzs7O0NBNEJ2QixFQUFVLENBQWxCLENBQXVCLENBQWpCLENBQU47SUFsRkE7OztDQW1GUSxFQUFnQixDQUF4QixDQUFBLENBQU0sQ0FBUztJQW5GZjtDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiU3BpbmUgID0gQFNwaW5lIG9yIHJlcXVpcmUoJ3NwaW5lJylcbiQgICAgICA9IFNwaW5lLiRcblxuY2xhc3MgU3BpbmUuTWFuYWdlciBleHRlbmRzIFNwaW5lLk1vZHVsZVxuICBAaW5jbHVkZSBTcGluZS5FdmVudHNcblxuICBjb25zdHJ1Y3RvcjogLT5cbiAgICBAY29udHJvbGxlcnMgPSBbXVxuICAgIEBiaW5kICdjaGFuZ2UnLCBAY2hhbmdlXG4gICAgQGFkZChhcmd1bWVudHMuLi4pXG5cbiAgYWRkOiAoY29udHJvbGxlcnMuLi4pIC0+XG4gICAgQGFkZE9uZShjb250KSBmb3IgY29udCBpbiBjb250cm9sbGVyc1xuXG4gIGFkZE9uZTogKGNvbnRyb2xsZXIpIC0+XG4gICAgY29udHJvbGxlci5iaW5kICdhY3RpdmUnLCAoYXJncy4uLikgPT5cbiAgICAgIEB0cmlnZ2VyKCdjaGFuZ2UnLCBjb250cm9sbGVyLCBhcmdzLi4uKVxuICAgIGNvbnRyb2xsZXIuYmluZCAncmVsZWFzZScsID0+XG4gICAgICBAY29udHJvbGxlcnMuc3BsaWNlKEBjb250cm9sbGVycy5pbmRleE9mKGNvbnRyb2xsZXIpLCAxKVxuXG4gICAgQGNvbnRyb2xsZXJzLnB1c2goY29udHJvbGxlcilcblxuICBkZWFjdGl2YXRlOiAtPlxuICAgIEB0cmlnZ2VyKCdjaGFuZ2UnLCBmYWxzZSwgYXJndW1lbnRzLi4uKVxuXG4gICMgUHJpdmF0ZVxuXG4gIGNoYW5nZTogKGN1cnJlbnQsIGFyZ3MuLi4pIC0+XG4gICAgZm9yIGNvbnQgaW4gQGNvbnRyb2xsZXJzXG4gICAgICBpZiBjb250IGlzIGN1cnJlbnRcbiAgICAgICAgY29udC5hY3RpdmF0ZShhcmdzLi4uKVxuICAgICAgZWxzZVxuICAgICAgICBjb250LmRlYWN0aXZhdGUoYXJncy4uLilcblxuU3BpbmUuQ29udHJvbGxlci5pbmNsdWRlXG4gIGFjdGl2ZTogKGFyZ3MuLi4pIC0+XG4gICAgaWYgdHlwZW9mIGFyZ3NbMF0gaXMgJ2Z1bmN0aW9uJ1xuICAgICAgQGJpbmQoJ2FjdGl2ZScsIGFyZ3NbMF0pXG4gICAgZWxzZVxuICAgICAgYXJncy51bnNoaWZ0KCdhY3RpdmUnKVxuICAgICAgQHRyaWdnZXIoYXJncy4uLilcbiAgICBAXG5cbiAgaXNBY3RpdmU6IC0+XG4gICAgQGVsLmhhc0NsYXNzKCdhY3RpdmUnKVxuXG4gIGFjdGl2YXRlOiAtPlxuICAgIEBlbC5hZGRDbGFzcygnYWN0aXZlJylcbiAgICBAXG5cbiAgZGVhY3RpdmF0ZTogLT5cbiAgICBAZWwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpXG4gICAgQFxuXG5jbGFzcyBTcGluZS5TdGFjayBleHRlbmRzIFNwaW5lLkNvbnRyb2xsZXJcbiAgY29udHJvbGxlcnM6IHt9XG4gIHJvdXRlczoge31cblxuICBjbGFzc05hbWU6ICdzcGluZSBzdGFjaydcblxuICBjb25zdHJ1Y3RvcjogLT5cbiAgICBzdXBlclxuXG4gICAgQG1hbmFnZXIgPSBuZXcgU3BpbmUuTWFuYWdlclxuXG4gICAgZm9yIGtleSwgdmFsdWUgb2YgQGNvbnRyb2xsZXJzXG4gICAgICB0aHJvdyBFcnJvciBcIidAI3sga2V5IH0nIGFscmVhZHkgYXNzaWduZWQgLSBjaG9vc2UgYSBkaWZmZXJlbnQgbmFtZVwiIGlmIEBba2V5XT9cbiAgICAgIEBba2V5XSA9IG5ldyB2YWx1ZShzdGFjazogQClcbiAgICAgIEBhZGQoQFtrZXldKVxuXG4gICAgZm9yIGtleSwgdmFsdWUgb2YgQHJvdXRlc1xuICAgICAgZG8gKGtleSwgdmFsdWUpID0+XG4gICAgICAgIGNhbGxiYWNrID0gdmFsdWUgaWYgdHlwZW9mIHZhbHVlIGlzICdmdW5jdGlvbidcbiAgICAgICAgY2FsbGJhY2sgb3I9ID0+IEBbdmFsdWVdLmFjdGl2ZShhcmd1bWVudHMuLi4pXG4gICAgICAgIEByb3V0ZShrZXksIGNhbGxiYWNrKVxuXG4gICAgQFtAZGVmYXVsdF0uYWN0aXZlKCkgaWYgQGRlZmF1bHRcblxuICBhZGQ6IChjb250cm9sbGVyKSAtPlxuICAgIEBtYW5hZ2VyLmFkZChjb250cm9sbGVyKVxuICAgIEBhcHBlbmQoY29udHJvbGxlcilcblxubW9kdWxlPy5leHBvcnRzID0gU3BpbmUuTWFuYWdlclxubW9kdWxlPy5leHBvcnRzLlN0YWNrID0gU3BpbmUuU3RhY2siXX0=
// Generated by CoffeeScript 1.6.1
(function() {
  var $, Spine,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    __slice = [].slice;

  Spine = this.Spine || require('spine');

  $ = Spine.$;

  Spine.Manager = (function(_super) {

    __extends(Manager, _super);

    Manager.include(Spine.Events);

    function Manager() {
      this.controllers = [];
      this.bind('change', this.change);
      this.add.apply(this, arguments);
    }

    Manager.prototype.add = function() {
      var cont, controllers, _i, _len, _results;
      controllers = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      _results = [];
      for (_i = 0, _len = controllers.length; _i < _len; _i++) {
        cont = controllers[_i];
        _results.push(this.addOne(cont));
      }
      return _results;
    };

    Manager.prototype.addOne = function(controller) {
      var _this = this;
      controller.bind('active', function() {
        var args;
        args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
        return _this.trigger.apply(_this, ['change', controller].concat(__slice.call(args)));
      });
      controller.bind('release', function() {
        return _this.controllers.splice(_this.controllers.indexOf(controller), 1);
      });
      return this.controllers.push(controller);
    };

    Manager.prototype.deactivate = function() {
      return this.trigger.apply(this, ['change', false].concat(__slice.call(arguments)));
    };

    Manager.prototype.change = function() {
      var args, cont, current, _i, _len, _ref, _results;
      current = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
      _ref = this.controllers;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        cont = _ref[_i];
        if (cont === current) {
          _results.push(cont.activate.apply(cont, args));
        } else {
          _results.push(cont.deactivate.apply(cont, args));
        }
      }
      return _results;
    };

    return Manager;

  })(Spine.Module);

  Spine.Controller.include({
    active: function() {
      var args;
      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      if (typeof args[0] === 'function') {
        this.bind('active', args[0]);
      } else {
        args.unshift('active');
        this.trigger.apply(this, args);
      }
      return this;
    },
    isActive: function() {
      return this.el.hasClass('active');
    },
    activate: function() {
      this.el.addClass('active');
      return this;
    },
    deactivate: function() {
      this.el.removeClass('active');
      return this;
    }
  });

  Spine.Stack = (function(_super) {

    __extends(Stack, _super);

    Stack.prototype.controllers = {};

    Stack.prototype.routes = {};

    Stack.prototype.className = 'spine stack';

    function Stack() {
      var key, value, _fn, _ref, _ref1,
        _this = this;
      Stack.__super__.constructor.apply(this, arguments);
      this.manager = new Spine.Manager;
      _ref = this.controllers;
      for (key in _ref) {
        value = _ref[key];
        if (this[key] != null) {
          throw Error("'@" + key + "' already assigned - choose a different name");
        }
        this[key] = new value({
          stack: this
        });
        this.add(this[key]);
      }
      _ref1 = this.routes;
      _fn = function(key, value) {
        var callback;
        if (typeof value === 'function') {
          callback = value;
        }
        callback || (callback = function() {
          var _ref2;
          return (_ref2 = _this[value]).active.apply(_ref2, arguments);
        });
        return _this.route(key, callback);
      };
      for (key in _ref1) {
        value = _ref1[key];
        _fn(key, value);
      }
      if (this["default"]) {
        this[this["default"]].active();
      }
    }

    Stack.prototype.add = function(controller) {
      this.manager.add(controller);
      return this.append(controller);
    };

    return Stack;

  })(Spine.Controller);

  if (typeof module !== "undefined" && module !== null) {
    module.exports = Spine.Manager;
  }

  if (typeof module !== "undefined" && module !== null) {
    module.exports.Stack = Spine.Stack;
  }

}).call(this);
